
name: Flask CI PYTest

on:
  push:
    branches: [ "main" ]


jobs:
  build:
    runs-on: ubuntu-20.04


    steps:
    - uses: actions/checkout@v2
      with:
          fetch-depth: 0

    - name: Install Dependencies ğŸ›©ï¸
      run: |
        python -m pip install --upgrade pip
        if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
    
    - name: Run Tests 
      run: |
         pytest -vs --html=reports/index.html --self-contained-html --md-report

    - name: HTML Preview ğŸ’‹
      id: html_preview
      uses: pavi2410/html-preview-action@v2
      with:
        html_file: 'reports/index.html'

    - name: Deploy ğŸš€
      uses: JamesIves/github-pages-deploy-action@v4
      with:
        GITHUB_TOKEN: ${{ secrets.gh_token }}
        folder: reports # The folder the action should deploy.